# 可行性

## 用Rust改写的可行性分析
用Rust重写3FS文件系统的可行性

### 技术可行性
+ Rust与FUSE的兼容性： Rust通过fuser库提供了与FUSE的良好集成。fuser封装了FUSE的低级接口，允许开发者用Rust实现文件系统的核心逻辑（如readdir、read、write等）
+ 安全性优势： Rust的内存安全特性（无数据竞争、避免空指针问题）非常适合文件系统开发，可以减少传统C实现中常见的bug（如缓冲区溢出）。对于3FS这种可能涉及复杂数据处理的系统，Rust能提升代码的健壮性。
+ 生态支持： Rust有丰富的异步编程支持（如tokio、async-std），Rust的工具链适合高并发或异步I/O。
+ Rust和C/C++在很多场景中都可以实现兼容：当前已经有很多成功的用Rust语言对C/C++代码改写的工作。Rust的性能与C/C++相当，因为它也是零成本抽象的语言。重写后，3FS的性能不会因为语言切换而下降，甚至可能通过Rust的优化（如更好的并发模型）有所提升。但是安全性一定会有提升，避免内存泄漏等问题
### 开发成本
+ 学习曲线： 需要团队学习Rust的语法和所有权模型，初期会有一定的学习成本。但在代码工具等辅助下，熟练掌握后可以保证改写的正确性

## 开发3FS的可行性
### 源码的获取
3FS文件系统在github上开源，其主要用C/C++代码完成绝大部分内容的编写。

### 模块化设计  
+ 3FS采用模块化设计，选择对FUSE等部分模块改写，只需改写内容对应调整接口等即可，工作量可控

+ 采用原型验证-->逐步迁移-->性能测试的方法可以分析和调试改写的代码：
先重写核心逻辑，将3FS的小功能（如目录读取）逐个移植到Rust，确保其正确性之后再进行下个功能的移植。保留FUSE交互部分用C（通过FFI）。最后用Rust完全替换FUSE交互层。

### 硬件部署问题
3FS可以在个人本机部署，由于硬件的限制，虽然无法对性能方面进行充分评测，但是可以检测改写和升级是否正确、代码能否运行。

## 创新点
当前有很多采用Rust改写的工作，3FS作为Deepseek大模型的高速文件系统，目前3FS由于开源时间较短，在Rust改写相关工作还有较大空白
FUSE作为用户空间文件系统模块，有很多相关的优化工作，如XFUSE、RFUSE等，对性能进行了提高，尝试将它们作为参考，应用到3FS的FUSE模块上
我们考虑采用Rust改写和参考XFUSE等对FUSE模块优化工作结合的方式，达到升级3FS的效果